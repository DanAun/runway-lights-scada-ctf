services:
  ics:
    hostname: eurobay-ics
    build:
      context: .
      dockerfile: docker/Dockerfile.ics
    image: ics_image
    container_name: ics
    environment:
      - ICS_SERVER_PORT=502
      - ICS_API_PORT=54321
    networks:
      - internal-net
    restart: always

  scada:
    hostname: eurobay-scada
    build:
      context: .
      dockerfile: docker/Dockerfile.scada
    image: scada_image
    container_name: scada
    ports:
      - "192.168.1.20:80:80"
      - "192.168.1.20:23:23"
      - "192.168.1.20:21:21"
      - "192.168.1.20:30000-30001:30000-30001"
    environment:
      - ICS_SERVER_PORT=502
      - ICS_SERVER_IP=ics
      - SCADA_WEB_PORT=80
    networks:
      internal-net:
        ipv4_address: 192.168.1.20
    depends_on:
      - ics
    cap_add:
      - NET_ADMIN
      - NET_RAW
    restart: always

networks:
  internal-net:
    driver: bridge
    ipam:
      config:
      - subnet: 192.168.1.0/24
