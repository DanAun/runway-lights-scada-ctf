services:
  ics:
    hostname: eurobay-ics
    build:
      context: .
      dockerfile: docker/Dockerfile.ics
    image: ics_image
    container_name: ics
    ports:
      - "54321:54321"
      - "502:502"
    environment:
      - ICS_SERVER_PORT=502
      - ICS_API_PORT=54321
    networks:
      - internal-net

  scada:
    hostname: eurobay-scada
    build:
      context: .
      dockerfile: docker/Dockerfile.scada
    image: scada_image
    container_name: scada
    ports:
      - "8000:8000"
      - "23:23"
      - "21:21"
      - "30000-30001:30000-30001"
    environment:
      - ICS_SERVER_PORT=502
      - ICS_SERVER_IP=ics
      - SCADA_WEB_PORT=8000
    networks:
      internal-net:
        ipv4_address: 192.168.1.20
    depends_on:
      - ics
    cap_add:
      - NET_ADMIN
      - NET_RAW

networks:
  internal-net:
    driver: bridge
    ipam:
      config:
      - subnet: 192.168.1.0/24
